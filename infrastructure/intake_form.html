<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GAADP Project Intake</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: #0d1117;
            color: #c9d1d9;
            min-height: 100vh;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 28px;
            font-weight: 600;
            color: #58a6ff;
            margin-bottom: 10px;
        }

        .header p {
            color: #8b949e;
            font-size: 14px;
        }

        .phase-indicator {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .phase {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: #8b949e;
        }

        .phase.active {
            color: #3fb950;
        }

        .phase-dot {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: 2px solid #30363d;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
        }

        .phase.active .phase-dot {
            background: #3fb950;
            border-color: #3fb950;
            color: #0d1117;
        }

        .phase.completed .phase-dot {
            background: #238636;
            border-color: #238636;
            color: white;
        }

        .form-section {
            background: #161b22;
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 20px;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .section-header h2 {
            font-size: 16px;
            font-weight: 600;
            color: #c9d1d9;
        }

        .section-header .badge {
            background: #30363d;
            color: #8b949e;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group:last-child {
            margin-bottom: 0;
        }

        .form-group label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            color: #c9d1d9;
            margin-bottom: 8px;
        }

        .form-group label .required {
            color: #f85149;
        }

        .form-group label .question-id {
            color: #8b949e;
            font-weight: 400;
            font-size: 12px;
            margin-left: 8px;
        }

        .form-group .hint {
            font-size: 12px;
            color: #8b949e;
            margin-bottom: 8px;
        }

        input[type="text"],
        textarea {
            width: 100%;
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 6px;
            padding: 10px 12px;
            font-size: 14px;
            color: #c9d1d9;
            font-family: inherit;
            transition: border-color 0.2s;
        }

        input[type="text"]:focus,
        textarea:focus {
            outline: none;
            border-color: #58a6ff;
        }

        textarea {
            min-height: 80px;
            resize: vertical;
        }

        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 6px;
            padding: 8px 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .checkbox-item:hover {
            border-color: #58a6ff;
        }

        .checkbox-item.selected {
            border-color: #3fb950;
            background: rgba(63, 185, 80, 0.1);
        }

        .checkbox-item input {
            display: none;
        }

        .checkbox-item .check {
            width: 16px;
            height: 16px;
            border: 2px solid #30363d;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .checkbox-item.selected .check {
            background: #3fb950;
            border-color: #3fb950;
        }

        .checkbox-item.selected .check::after {
            content: '‚úì';
            color: white;
            font-size: 10px;
            font-weight: bold;
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .radio-item {
            display: flex;
            align-items: center;
            gap: 10px;
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 6px;
            padding: 12px 16px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .radio-item:hover {
            border-color: #58a6ff;
        }

        .radio-item.selected {
            border-color: #3fb950;
            background: rgba(63, 185, 80, 0.1);
        }

        .radio-item input {
            display: none;
        }

        .radio-item .radio {
            width: 18px;
            height: 18px;
            border: 2px solid #30363d;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .radio-item.selected .radio {
            border-color: #3fb950;
        }

        .radio-item.selected .radio::after {
            content: '';
            width: 10px;
            height: 10px;
            background: #3fb950;
            border-radius: 50%;
        }

        .radio-item .label-content {
            flex: 1;
        }

        .radio-item .label-content .title {
            font-weight: 500;
        }

        .radio-item .label-content .description {
            font-size: 12px;
            color: #8b949e;
            margin-top: 2px;
        }

        /* Feature List */
        .feature-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 8px;
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 6px;
            padding: 8px 12px;
        }

        .feature-item input {
            flex: 1;
            background: transparent;
            border: none;
            color: #c9d1d9;
            font-size: 14px;
        }

        .feature-item input:focus {
            outline: none;
        }

        .feature-item .remove-btn {
            background: none;
            border: none;
            color: #f85149;
            cursor: pointer;
            font-size: 18px;
            padding: 4px;
            opacity: 0.6;
            transition: opacity 0.2s;
        }

        .feature-item .remove-btn:hover {
            opacity: 1;
        }

        .add-feature-btn {
            background: #21262d;
            border: 1px dashed #30363d;
            border-radius: 6px;
            padding: 10px;
            color: #8b949e;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
        }

        .add-feature-btn:hover {
            border-color: #58a6ff;
            color: #58a6ff;
        }

        /* Actions */
        .form-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 30px;
        }

        .btn {
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
        }

        .btn-secondary {
            background: #21262d;
            color: #c9d1d9;
            border: 1px solid #30363d;
        }

        .btn-secondary:hover {
            background: #30363d;
        }

        .btn-primary {
            background: #238636;
            color: white;
        }

        .btn-primary:hover {
            background: #2ea043;
        }

        .btn-primary:disabled {
            background: #21262d;
            color: #484f58;
            cursor: not-allowed;
        }

        /* Progress */
        .progress-bar {
            height: 4px;
            background: #21262d;
            border-radius: 2px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .progress-bar .fill {
            height: 100%;
            background: linear-gradient(90deg, #3fb950, #58a6ff);
            transition: width 0.3s;
        }

        /* Toast notification */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #161b22;
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 16px 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        .toast.success {
            border-color: #3fb950;
        }

        .toast.success .icon {
            color: #3fb950;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }

        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: #161b22;
            border: 1px solid #30363d;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow: auto;
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid #30363d;
        }

        .modal-header h3 {
            font-size: 18px;
            font-weight: 600;
        }

        .modal-body {
            padding: 20px;
        }

        .modal-footer {
            padding: 20px;
            border-top: 1px solid #30363d;
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }

        /* Code preview */
        .code-preview {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 6px;
            padding: 16px;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', monospace;
            font-size: 12px;
            overflow-x: auto;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ GAADP Project Intake</h1>
            <p>Phase 1: Deterministic Requirements Collection</p>
        </div>

        <div class="phase-indicator">
            <div class="phase active">
                <div class="phase-dot">1</div>
                <span>Intake Form</span>
            </div>
            <div class="phase">
                <div class="phase-dot">2</div>
                <span>Socratic Q&A</span>
            </div>
            <div class="phase">
                <div class="phase-dot">3</div>
                <span>Spec Generation</span>
            </div>
        </div>

        <div class="progress-bar">
            <div class="fill" id="progressFill" style="width: 0%"></div>
        </div>

        <form id="intakeForm">
            <!-- Problem Statement -->
            <div class="form-section">
                <div class="section-header">
                    <h2>üìå Problem & Users</h2>
                    <span class="badge">Required</span>
                </div>

                <div class="form-group">
                    <label>
                        What is the single most important problem this software solves?
                        <span class="required">*</span>
                        <span class="question-id">L1.01</span>
                    </label>
                    <textarea name="problem_statement" required placeholder="e.g., Automate invoice processing to save 10 hours/week"></textarea>
                </div>

                <div class="form-group">
                    <label>
                        Who exactly will use this? Describe the person at the keyboard.
                        <span class="required">*</span>
                        <span class="question-id">L1.02</span>
                    </label>
                    <div class="hint">e.g., "A busy accountant reviewing financial data" or "A teenager browsing social media"</div>
                    <textarea name="user_persona" required placeholder="Describe your typical user..."></textarea>
                </div>
            </div>

            <!-- Integration & Compliance -->
            <div class="form-section">
                <div class="section-header">
                    <h2>üîó Integration & Compliance</h2>
                </div>

                <div class="form-group">
                    <label>
                        Does this need to connect to any existing systems?
                        <span class="question-id">L1.03</span>
                    </label>
                    <div class="hint">e.g., Salesforce, SAP, PostgreSQL, REST APIs</div>
                    <textarea name="integrations" placeholder="List any systems this needs to connect to, or 'None'"></textarea>
                </div>

                <div class="form-group">
                    <label>
                        Are there legal or industry rules we must follow?
                        <span class="question-id">L1.04</span>
                    </label>
                    <div class="checkbox-group" id="complianceGroup">
                        <label class="checkbox-item" onclick="toggleCheckbox(this)">
                            <input type="checkbox" name="compliance" value="HIPAA">
                            <span class="check"></span>
                            <span>HIPAA</span>
                        </label>
                        <label class="checkbox-item" onclick="toggleCheckbox(this)">
                            <input type="checkbox" name="compliance" value="GDPR">
                            <span class="check"></span>
                            <span>GDPR</span>
                        </label>
                        <label class="checkbox-item" onclick="toggleCheckbox(this)">
                            <input type="checkbox" name="compliance" value="PCI-DSS">
                            <span class="check"></span>
                            <span>PCI-DSS</span>
                        </label>
                        <label class="checkbox-item" onclick="toggleCheckbox(this)">
                            <input type="checkbox" name="compliance" value="SOC2">
                            <span class="check"></span>
                            <span>SOC2</span>
                        </label>
                        <label class="checkbox-item" onclick="toggleCheckbox(this)">
                            <input type="checkbox" name="compliance" value="None">
                            <span class="check"></span>
                            <span>None</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Constraints -->
            <div class="form-section">
                <div class="section-header">
                    <h2>‚è±Ô∏è Timeline & Budget</h2>
                </div>

                <div class="form-group">
                    <label>
                        Is there a hard deadline?
                        <span class="question-id">L1.05</span>
                    </label>
                    <input type="text" name="timeline" placeholder="e.g., 'Launch by Q1 2025', 'Demo next Tuesday', or 'No hard deadline'">
                </div>

                <div class="form-group">
                    <label>
                        Is there a budget limit for building or running this?
                        <span class="question-id">L1.06</span>
                    </label>
                    <input type="text" name="budget" placeholder="e.g., '$5000 total', '$100/month hosting', or 'No budget constraint'">
                </div>
            </div>

            <!-- Scale & Platform -->
            <div class="form-section">
                <div class="section-header">
                    <h2>üìä Scale & Platform</h2>
                </div>

                <div class="form-group">
                    <label>
                        How many people will use this at once?
                        <span class="question-id">L1.07</span>
                    </label>
                    <div style="display: flex; gap: 12px;">
                        <div style="flex: 1;">
                            <div class="hint">Current</div>
                            <input type="text" name="scale_current" placeholder="e.g., 10 users">
                        </div>
                        <div style="flex: 1;">
                            <div class="hint">In 1 year</div>
                            <input type="text" name="scale_projected" placeholder="e.g., 100 users">
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>
                        Where will people use this?
                        <span class="question-id">L1.08</span>
                    </label>
                    <div class="checkbox-group" id="platformGroup">
                        <label class="checkbox-item" onclick="toggleCheckbox(this)">
                            <input type="checkbox" name="platform" value="Web browser">
                            <span class="check"></span>
                            <span>Web browser</span>
                        </label>
                        <label class="checkbox-item" onclick="toggleCheckbox(this)">
                            <input type="checkbox" name="platform" value="Mobile (iOS)">
                            <span class="check"></span>
                            <span>Mobile (iOS)</span>
                        </label>
                        <label class="checkbox-item" onclick="toggleCheckbox(this)">
                            <input type="checkbox" name="platform" value="Mobile (Android)">
                            <span class="check"></span>
                            <span>Mobile (Android)</span>
                        </label>
                        <label class="checkbox-item" onclick="toggleCheckbox(this)">
                            <input type="checkbox" name="platform" value="Desktop">
                            <span class="check"></span>
                            <span>Desktop</span>
                        </label>
                        <label class="checkbox-item" onclick="toggleCheckbox(this)">
                            <input type="checkbox" name="platform" value="CLI">
                            <span class="check"></span>
                            <span>CLI tool</span>
                        </label>
                        <label class="checkbox-item" onclick="toggleCheckbox(this)">
                            <input type="checkbox" name="platform" value="API only">
                            <span class="check"></span>
                            <span>API/Backend only</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Trade-off -->
            <div class="form-section">
                <div class="section-header">
                    <h2>‚öñÔ∏è Trade-off</h2>
                </div>

                <div class="form-group">
                    <label>
                        If you had to choose: get something working fast, or build it to last?
                        <span class="required">*</span>
                        <span class="question-id">L1.09</span>
                    </label>
                    <div class="radio-group" id="tradeoffGroup">
                        <label class="radio-item" onclick="selectRadio(this, 'tradeoff')">
                            <input type="radio" name="tradeoff" value="MVP" required>
                            <span class="radio"></span>
                            <div class="label-content">
                                <div class="title">MVP/Prototype</div>
                                <div class="description">Get something working fast, can refactor later</div>
                            </div>
                        </label>
                        <label class="radio-item" onclick="selectRadio(this, 'tradeoff')">
                            <input type="radio" name="tradeoff" value="Production">
                            <span class="radio"></span>
                            <div class="label-content">
                                <div class="title">Production-grade</div>
                                <div class="description">Built to last, handle scale, maintainable code</div>
                            </div>
                        </label>
                        <label class="radio-item" onclick="selectRadio(this, 'tradeoff')">
                            <input type="radio" name="tradeoff" value="Balanced">
                            <span class="radio"></span>
                            <div class="label-content">
                                <div class="title">Balanced</div>
                                <div class="description">Good enough for now, but with room to grow</div>
                            </div>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Features -->
            <div class="form-section">
                <div class="section-header">
                    <h2>‚ú® Features</h2>
                    <span class="badge">Required</span>
                </div>

                <div class="form-group">
                    <label>
                        What features do you need?
                        <span class="required">*</span>
                    </label>
                    <div class="hint">List each feature as a separate item</div>
                    <div class="feature-list" id="featureList">
                        <div class="feature-item">
                            <input type="text" name="features[]" placeholder="Feature 1" required>
                            <button type="button" class="remove-btn" onclick="removeFeature(this)">√ó</button>
                        </div>
                    </div>
                    <div class="add-feature-btn" onclick="addFeature()">+ Add another feature</div>
                </div>

                <div class="form-group">
                    <label>
                        What else do you want the code to do? (Anything we missed?)
                    </label>
                    <textarea name="additional" placeholder="Any other requirements, constraints, or preferences..."></textarea>
                </div>
            </div>

            <!-- Delegation -->
            <div class="form-section">
                <div class="section-header">
                    <h2>ü§ñ Delegation</h2>
                </div>

                <div class="form-group">
                    <label>
                        What can the AI decide for you? (Skip means "use your best judgment")
                        <span class="question-id">T2</span>
                    </label>
                    <div class="checkbox-group" id="delegationGroup">
                        <label class="checkbox-item" onclick="toggleCheckbox(this)">
                            <input type="checkbox" name="delegation" value="Error handling">
                            <span class="check"></span>
                            <span>Error handling details</span>
                        </label>
                        <label class="checkbox-item" onclick="toggleCheckbox(this)">
                            <input type="checkbox" name="delegation" value="Code style">
                            <span class="check"></span>
                            <span>Code style/formatting</span>
                        </label>
                        <label class="checkbox-item" onclick="toggleCheckbox(this)">
                            <input type="checkbox" name="delegation" value="Test coverage">
                            <span class="check"></span>
                            <span>Test coverage level</span>
                        </label>
                        <label class="checkbox-item" onclick="toggleCheckbox(this)">
                            <input type="checkbox" name="delegation" value="Performance">
                            <span class="check"></span>
                            <span>Performance optimizations</span>
                        </label>
                    </div>
                </div>
            </div>

            <div class="form-actions">
                <button type="button" class="btn btn-secondary" onclick="previewPrompt()">Preview prompt.md</button>
                <button type="submit" class="btn btn-primary" id="submitBtn">Generate prompt.md ‚Üí</button>
            </div>
        </form>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast">
        <span class="icon">‚úì</span>
        <span class="message">prompt.md generated successfully!</span>
    </div>

    <!-- Preview Modal -->
    <div class="modal-overlay" id="previewModal">
        <div class="modal">
            <div class="modal-header">
                <h3>üìÑ Preview: prompt.md</h3>
            </div>
            <div class="modal-body">
                <pre class="code-preview" id="previewContent"></pre>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal()">Close</button>
                <button type="button" class="btn btn-primary" onclick="downloadPrompt()">Download</button>
            </div>
        </div>
    </div>

    <script>
        // Toggle checkbox styling
        function toggleCheckbox(element) {
            element.classList.toggle('selected');
            const checkbox = element.querySelector('input');
            checkbox.checked = !checkbox.checked;
            updateProgress();
        }

        // Select radio button
        function selectRadio(element, groupName) {
            const group = element.parentElement;
            group.querySelectorAll('.radio-item').forEach(item => {
                item.classList.remove('selected');
                item.querySelector('input').checked = false;
            });
            element.classList.add('selected');
            element.querySelector('input').checked = true;
            updateProgress();
        }

        // Feature list management
        function addFeature() {
            const list = document.getElementById('featureList');
            const count = list.children.length + 1;
            const item = document.createElement('div');
            item.className = 'feature-item';
            item.innerHTML = `
                <input type="text" name="features[]" placeholder="Feature ${count}">
                <button type="button" class="remove-btn" onclick="removeFeature(this)">√ó</button>
            `;
            list.appendChild(item);
        }

        function removeFeature(btn) {
            const list = document.getElementById('featureList');
            if (list.children.length > 1) {
                btn.parentElement.remove();
            }
        }

        // Progress tracking
        function updateProgress() {
            const form = document.getElementById('intakeForm');
            const required = form.querySelectorAll('[required]');
            let filled = 0;

            required.forEach(field => {
                if (field.type === 'radio') {
                    const name = field.name;
                    if (form.querySelector(`input[name="${name}"]:checked`)) {
                        filled++;
                    }
                } else if (field.value.trim()) {
                    filled++;
                }
            });

            const uniqueRequired = new Set([...required].map(f => f.name)).size;
            const progress = (filled / uniqueRequired) * 100;
            document.getElementById('progressFill').style.width = `${progress}%`;
        }

        // Generate prompt.md content
        function generatePromptMd() {
            const form = document.getElementById('intakeForm');
            const data = new FormData(form);

            const timestamp = new Date().toISOString().replace('T', ' ').split('.')[0];

            // Get features
            const features = [...form.querySelectorAll('input[name="features[]"]')]
                .map(f => f.value.trim())
                .filter(f => f);

            // Get checkboxes
            const getChecked = (name) => [...form.querySelectorAll(`input[name="${name}"]:checked`)]
                .map(c => c.value);

            const compliance = getChecked('compliance');
            const platforms = getChecked('platform');
            const delegations = getChecked('delegation');

            let content = `# GAADP Project Specification
# Generated: ${timestamp}
# Phase: Deterministic Intake (Phase 1)

---

## L1: System-Level Requirements

### Problem Statement
**L1.01**
\`\`\`
${data.get('problem_statement') || 'Not specified'}
\`\`\`

### User Persona
**L1.02**
\`\`\`
${data.get('user_persona') || 'Not specified'}
\`\`\`

### System Integration
**L1.03**
\`\`\`
${data.get('integrations') || 'None'}
\`\`\`

### Regulatory Compliance
**L1.04**
\`\`\`
${compliance.length ? compliance.join(', ') : 'None'}
\`\`\`

### Timeline Constraint
**L1.05**
\`\`\`
${data.get('timeline') || 'No hard deadline'}
\`\`\`

### Budget Constraint
**L1.06**
\`\`\`
${data.get('budget') || 'No budget constraint'}
\`\`\`

### Concurrency Scale
**L1.07**
\`\`\`
Current: ${data.get('scale_current') || 'Not specified'}, Projected: ${data.get('scale_projected') || 'Not specified'}
\`\`\`

### Platform Target
**L1.08**
\`\`\`
${platforms.length ? platforms.join(', ') : 'Not specified'}
\`\`\`

### Speed vs Robustness Trade-off
**L1.09**
\`\`\`
${data.get('tradeoff') || 'Not specified'}
\`\`\`

---

## Feature List

### Core Features
${features.map(f => `- [ ] ${f}`).join('\n') || '- (No features specified)'}

${data.get('additional') ? `### Additional Requirements
\`\`\`
${data.get('additional')}
\`\`\`` : ''}

---

## Delegation License

The user has granted the following delegation permissions:

${delegations.length && !delegations.includes('None')
    ? delegations.map(d => `- **${d}**: Agent may decide`).join('\n')
    : '- **None**: User wants to be asked about all decisions'}

---

## Phase 2: Dialectic Specification Status

- [ ] Socrates analysis complete
- [ ] All blocking clarifications resolved
- [ ] L2 module decomposition complete
- [ ] L3 structural validators passed

---

*This document was generated by GAADP Deterministic Intake.*
*Phase 2 (Dialectic Specification) will extend this with L2/L3 details.*
`;
            return content;
        }

        // Preview modal
        function previewPrompt() {
            const content = generatePromptMd();
            document.getElementById('previewContent').textContent = content;
            document.getElementById('previewModal').classList.add('show');
        }

        function closeModal() {
            document.getElementById('previewModal').classList.remove('show');
        }

        // Download prompt.md
        function downloadPrompt() {
            const content = generatePromptMd();
            const blob = new Blob([content], { type: 'text/markdown' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'prompt.md';
            a.click();
            URL.revokeObjectURL(url);
            closeModal();
            showToast('prompt.md downloaded!');
        }

        // Toast notification
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.querySelector('.message').textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        // Form submission
        document.getElementById('intakeForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const content = generatePromptMd();

            // Try to send to server if available
            try {
                const response = await fetch('/api/intake', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ content })
                });

                if (response.ok) {
                    showToast('prompt.md saved! Starting Phase 2...');
                    // Could redirect to Socratic Q&A panel
                    setTimeout(() => {
                        window.location.href = '/socratic?prompt=prompt.md';
                    }, 1500);
                    return;
                }
            } catch (err) {
                // Server not available, fall back to download
            }

            // Fall back to download
            downloadPrompt();
        });

        // Initialize
        document.querySelectorAll('input, textarea').forEach(el => {
            el.addEventListener('input', updateProgress);
        });
        updateProgress();
    </script>
</body>
</html>
